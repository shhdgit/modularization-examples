<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/modularization-examples/styles.a7965b94cc071282aad0.css" id="gatsby-global-css">.popover{position:relative;max-width:16rem;box-shadow:0 10px 15px -3px var(--shadow),0 4px 6px -2px rgba(0,0,0,.05);padding:1rem;border:1px solid var(--separator);border-radius:.5rem;background-color:var(--references-bg);max-height:16rem;overflow:hidden}.popover.no-max-width{max-width:90vw}.popover.with-markdown{font-size:.875rem}.popover h1{margin:0;padding:0;font-size:1rem}.popover ul{padding-left:1rem}.popover .more-content-blind{height:4rem;position:absolute;background:transparent;background:linear-gradient(0,var(--references-bg),var(--references-bg-80) 50%,var(--references-bg-0));top:12rem;width:100%;left:0}.tippy-box[data-animation=shift-away][data-state=hidden]{opacity:0}.tippy-box[data-animation=shift-away][data-state=hidden][data-placement^=top]{-webkit-transform:translateY(10px);transform:translateY(10px)}.tippy-box[data-animation=shift-away][data-state=hidden][data-placement^=bottom]{-webkit-transform:translateY(-10px);transform:translateY(-10px)}.tippy-box[data-animation=shift-away][data-state=hidden][data-placement^=left]{-webkit-transform:translateX(10px);transform:translateX(10px)}.tippy-box[data-animation=shift-away][data-state=hidden][data-placement^=right]{-webkit-transform:translateX(-10px);transform:translateX(-10px)}.reference{text-decoration:none}.reference:hover{color:var(--references-highlight)}.reference>div{padding-top:.5rem;padding-bottom:.5rem}.reference>div>p{margin:0;font-size:.875rem}.reference>div>ul{margin:0}.references-block{color:var(--references-text);padding:1rem;margin:1rem 0;border-radius:.5rem;background-color:var(--references-bg);transition:background-color .3s ease,color .3s ease}.references-block>div{margin-bottom:1rem}.references-block>hr{margin-left:auto;margin-right:auto;width:8rem}.references-block a{color:var(--references-text);transition:color .3s ease}.references-block>p:last-child{margin-bottom:0}.note-container{background:var(--note-bg);transition:background .3s ease}.note-container:first-child{border-left:none}.note-container .note-content,.note-container .obstructed-label{transition:opacity 75ms linear}.note-container .obstructed-label{display:block;color:var(--text);text-decoration:none;font-size:17px;line-height:40px;font-weight:500;-webkit-writing-mode:vertical-lr;-ms-writing-mode:tb-lr;writing-mode:vertical-lr;-webkit-text-orientation:sideways;text-orientation:sideways;margin-top:36px;top:0;bottom:0;left:0;position:absolute;background-color:transparent;width:40px;overflow:hidden;opacity:0;transition:color .3s ease;pointer-events:none}.note-container.note-container-highlighted{background:var(--references-bg);transition:background .3s ease}.note-content img{max-width:100%}@media screen and (max-width:800px){.note-container{padding:16px;width:100%;overflow-y:auto}}@media screen and (min-width:801px){.note-container{transition:box-shadow .1s linear,opacity 75ms linear,-webkit-transform .2s cubic-bezier(.19,1,.22,1);transition:box-shadow .1s linear,opacity 75ms linear,transform .2s cubic-bezier(.19,1,.22,1);transition:box-shadow .1s linear,opacity 75ms linear,transform .2s cubic-bezier(.19,1,.22,1),-webkit-transform .2s cubic-bezier(.19,1,.22,1);flex-shrink:0;width:625px;max-width:625px;top:0;position:sticky;flex-grow:1;border-left:1px solid var(--separator);padding:0}.note-content{overflow-y:auto;height:100%;padding:32px}.note-container-overlay{box-shadow:0 0 15px 3px var(--shadow)}.note-container-obstructed .note-content{opacity:0}.note-container-obstructed .obstructed-label{opacity:1;pointer-events:all}}.dark-mode-toggle{cursor:pointer;-webkit-transform:scale(.6);transform:scale(.6)}.dark-mode-toggle input{display:none}.dark-mode-toggle input+div{border-radius:50%;width:36px;height:36px;position:relative;box-shadow:inset 16px -16px 0 0 #fff;-webkit-transform:scale(1) rotate(-2deg);transform:scale(1) rotate(-2deg);transition:box-shadow .5s ease 0s,-webkit-transform .4s ease .1s;transition:box-shadow .5s ease 0s,transform .4s ease .1s;transition:box-shadow .5s ease 0s,transform .4s ease .1s,-webkit-transform .4s ease .1s}.dark-mode-toggle input+div:before{content:"";width:inherit;height:inherit;border-radius:inherit;position:absolute;left:0;top:0;transition:background .3s ease}.dark-mode-toggle input+div:after{content:"";width:8px;height:8px;border-radius:50%;margin:-4px 0 0 -4px;position:absolute;top:50%;left:50%;box-shadow:0 -23px 0 var(--link),0 23px 0 var(--link),23px 0 0 var(--link),-23px 0 0 var(--link),15px 15px 0 var(--link),-15px 15px 0 var(--link),15px -15px 0 var(--link),-15px -15px 0 var(--link);-webkit-transform:scale(0);transform:scale(0);transition:all .3s ease}.dark-mode-toggle input:checked+div{box-shadow:inset 32px -32px 0 0 #fff;-webkit-transform:scale(.5) rotate(0deg);transform:scale(.5) rotate(0deg);transition:box-shadow .2s ease 0s,-webkit-transform .3s ease .1s;transition:transform .3s ease .1s,box-shadow .2s ease 0s;transition:transform .3s ease .1s,box-shadow .2s ease 0s,-webkit-transform .3s ease .1s}.dark-mode-toggle input:checked+:before{background:var(--link);transition:background .3s ease .1s}.dark-mode-toggle input:checked+:after{-webkit-transform:scale(1.5);transform:scale(1.5);transition:-webkit-transform .5s ease .15s;transition:transform .5s ease .15s;transition:transform .5s ease .15s,-webkit-transform .5s ease .15s}.graph-button{border:0;background:none;cursor:pointer}.graph-button svg g{stroke:var(--link)}.searchWrapper{position:relative;display:block}.inputWrapper{position:relative;color:var(--text)}.inputWrapper .searchIcon{position:absolute;fill:var(--link);left:2px;height:34px;padding:2px 2px 0;pointer-events:none}.inputWrapper input{color:var(--text);font-size:1rem;border:none;height:36px;padding-left:28px;background-color:var(--note-bg);transition:all .3s ease-in-out;width:28px}.inputWrapper input:focus{outline:none;width:100%}.results{-webkit-padding-start:0;padding-inline-start:0;position:absolute;display:block;top:100%;right:0;width:500px;max-height:50vh;background:var(--note-bg);box-shadow:-5px -5px 15px -3px var(--shadow),0 4px 6px -2px rgba(0,0,0,.05);overflow-y:auto;border-radius:8px}.results li{display:block;text-decoration:none;cursor:pointer;padding:16px 24px;border-bottom:1px solid var(--separator)}.results li:hover{background:var(--references-bg)}.results li .title{color:var(--text)}.results li .excerpt{color:var(--references-text)}@media screen and (max-width:600px){.results{right:-85px;width:calc(100vw - 40px)}}.lds-dual-ring:after{content:" ";left:calc(50% - 32px);position:relative;display:block;width:64px;height:64px;margin:8px;border-radius:50%;border-color:var(--separator);border-left:6px solid transparent;border-bottom:6px solid var(--separator);border-right:6px solid transparent;border-top:6px solid var(--separator);-webkit-animation:lds-dual-ring 1.2s ease-in-out infinite;animation:lds-dual-ring 1.2s ease-in-out infinite}@-webkit-keyframes lds-dual-ring{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes lds-dual-ring{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}header{width:100%;min-height:57px;z-index:5;background-color:var(--note-bg);border-bottom:1px solid var(--separator);display:flex;justify-content:space-between;align-items:center;padding:10px 32px;flex-wrap:wrap;transition:background-color .3s ease}header>a{font-weight:700;color:var(--text);text-decoration:none;transition:color .3s ease}header .controls{display:flex}html{font-family:system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;line-height:1.5}body.light-mode{--main-bg:#fafafc;--note-bg:#fff;--text:#1a202c;--separator:#e2e8f0;--shadow:rgba(0,0,0,0.1);--link:#3182ce;--references-bg:#ebf4ff;--references-bg-80:rgba(235,244,255,0.8);--references-bg-0:rgba(235,244,255,0);--references-text:#718096;--references-highlight:#4a5568}body.dark-mode{--main-bg:#000;--note-bg:#0a0d11;--text:#fafafc;--separator:#252525;--shadow:hsla(0,0%,100%,0.1);--link:#3da1ff;--references-bg:#17181a;--references-bg-80:rgba(23,24,26,0.8);--references-bg-0:rgba(23,24,26,0);--references-text:#8c9fbb;--references-highlight:#b3cbf0}body{background-color:var(--main-bg);color:var(--text);margin:0;padding:0;height:100vh;transition:background-color .3s ease,color .3s ease}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,p,pre{margin:0}pre{white-space:pre-wrap}*,:after,:before{box-sizing:border-box}h1,h2,h3{font-weight:700}hr{margin-top:1rem;margin-bottom:1rem;border:solid var(--separator);border-width:1px 0 0;box-sizing:content-box;height:0;overflow:visible}a{color:var(--link);text-decoration:underline;transition:color .3s ease}a:hover{text-decoration:none}h1{font-size:1.875rem;margin-top:1rem}h1,p{margin-bottom:1rem}.layout{height:100vh;display:flex;flex-direction:column}.note-columns-scrolling-container{display:flex;overflow-x:auto;overflow-y:hidden;flex-grow:1}.note-columns-container{display:flex;flex-grow:1;transition:width .1s cubic-bezier(.19,1,.22,1)}@media screen and (max-width:800px){.note-columns-container{width:unset!important}}.overlay{z-index:98;position:fixed;top:0;right:0;bottom:0;left:0;display:flex;align-items:center;justify-content:center;height:100%;width:100%;background-color:var(--shadow);-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.modal{z-index:99;position:fixed;border-radius:8px;background-color:var(--main-bg);box-shadow:-5px -5px 15px -3px var(--shadow),0 4px 6px -2px rgba(0,0,0,.05)}.modal-close,.modal-scale{position:absolute;top:0;right:0;padding:5px;border:0;background:none;color:var(--text);cursor:pointer}.modal-close svg,.modal-scale svg{width:20px;height:20px}.modal-close path,.modal-scale path{fill:currentColor}.modal-scale{right:30px}.modal-minimized .modal-close svg,.modal-minimized .modal-scale svg{width:15px;height:15px}.modal-minimized .modal-scale{right:25px}.modal-body{height:100%;width:100%}.modal-body .node,.modal-body .text{cursor:pointer}</style><meta name="generator" content="Gatsby 2.32.13"/><link as="script" rel="preload" href="/modularization-examples/component---node-modules-gatsby-theme-gardenx-src-templates-local-file-js-f7490a33359932c9c39b.js"/><link as="script" rel="preload" href="/modularization-examples/styles-407fe62976dc5310c43e.js"/><link as="script" rel="preload" href="/modularization-examples/app-2cf9a07a48aadf00be9a.js"/><link as="script" rel="preload" href="/modularization-examples/framework-06f646d936b841f99ebd.js"/><link as="script" rel="preload" href="/modularization-examples/webpack-runtime-17b9bea5f0059a6131f0.js"/><link as="fetch" rel="preload" href="/modularization-examples/page-data/autonomy/module-boundary-unchanged/packaging-deployment/README/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/modularization-examples/page-data/sq/d/2098632890.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/modularization-examples/page-data/sq/d/2221750479.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/modularization-examples/page-data/sq/d/2468095761.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/modularization-examples/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="layout"><header><a href="/modularization-examples/"><h3>业务逻辑拆分模式</h3></a><div class="controls"><div class="searchWrapper" role="combobox" aria-expanded="false" aria-haspopup="listbox" aria-labelledby="downshift-42-label"><div class="inputWrapper"><svg class="searchIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M23.111 20.058l-4.977-4.977c.965-1.52 1.523-3.322 1.523-5.251 0-5.42-4.409-9.83-9.829-9.83-5.42 0-9.828 4.41-9.828 9.83s4.408 9.83 9.829 9.83c1.834 0 3.552-.505 5.022-1.383l5.021 5.021c2.144 2.141 5.384-1.096 3.239-3.24zm-20.064-10.228c0-3.739 3.043-6.782 6.782-6.782s6.782 3.042 6.782 6.782-3.043 6.782-6.782 6.782-6.782-3.043-6.782-6.782z"></path></svg><input type="text" aria-autocomplete="list" aria-labelledby="downshift-42-label" autoComplete="off" value="" id="downshift-42-input" placeholder="Search..."/></div></div><button title="Show Graph visualisation" aria-label="Show Graph visualisation" class="graph-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20"><g fill="none" stroke-width="2"><circle cx="11.733" cy="3.181" r="1.902"></circle><circle cx="16.864" cy="10.861" r="1.902"></circle><circle cx="7.47" cy="16.822" r="1.902"></circle><circle cx="3.046" cy="6.275" r="1.902"></circle><circle cx="9.372" cy="10.861" r="1.902"></circle><line x1="11.635" x2="14.655" y1="10.861" y2="10.861"></line><line x1="10" x2="10.895" y1="8.959" y2="5.573"></line><line x1="7.47" x2="4.5" y1="9.68" y2="7.5"></line><line x1="8.25" x2="8.809" y1="14.92" y2="13.088"></line></g></svg></button><label class="dark-mode-toggle" aria-label="Activate dark mode" title="Activate dark mode"><input type="checkbox" checked=""/><div></div></label></div></header><div class="note-columns-scrolling-container"><div class="note-columns-container" style="width:1250px"><div class="note-container   " style="left:0;right:-585px"><div class="note-content"><p>以下是从<a href="https://sz.lianjia.com/tool/esfsf/">链家的网站</a>上截的几个图。这个工具是给中介帮二手房买卖双方计算税费使用的。</p><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:561px">
      <a class="gatsby-resp-image-link" style="display:block" target="_blank" rel="noopener" href="/modularization-examples/modularization-examples/static/4369a235f2e1dc45bac63813538889d8/3af77/luoyang.png">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:62.142857142857146%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAB2HAAAdhwGP5fFlAAACE0lEQVQoz3VSO2sUURSen2Wvha2VkBQGlLhYREWCEAJiZWdnwCBYiIiCYApbi4CFYMAHiIZ1s+M+M8/dnded1/08353d1Q164HBn7pzzPc4ZqyxLjEZjTCdTvH5zgEuX19DauoUr165je2cXYRii3x9gOBwhyzJ4nr981lrDcRy4rodFWFVVQakceZ5jFkVwXBeu55kiPwiQKSXNygCwhu/2rx46J12cdLvLs/2zY/qsOI5BULIFQYiiKEDVzKIoDRmToIxI6nfu3cf6xlXjZOvONm7cvI2NzRYePd6HNZlMEEoyqKCu65UkEZMEVMmz3W7j+/ExnPEQ476NsdgejkZi34UViU2qZCixQ5D/BZ3wuyfWGhFaLhXKqoaak1mz2QxUyUKC0zIbz2ZZLs4S7JlKj25oUBf5cs5WIup83zcvURQvP6ymQpo2WzWEAmpiMMCPbw6agWlTZyzbto0gDDAV8DhNTSYCxBEsksV1LYB5gYJLlHlDlvGytYevb48MJEmtOE9wGvuIVYJSyRykWYsFxtkFLRZHQFDp3V3o8xeB5y+MfZUksGiDMSlS7HcO8ar3EU+773Ew+DQ3olcWkwsQVZqQUenPX8hsqswMa90w24mPc+8eYP3DE1w4fIjNo2eNSv3n12kUcmnNDHO5Ync1V8/RWEaF1v/8Tf6+XzxzKVSSZAUcb4ak15OtR2YUiVj+DRGChl4c7pE2AAAAAElFTkSuQmCC&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="luoyang" title="luoyang" src="/modularization-examples/static/4369a235f2e1dc45bac63813538889d8/410f3/luoyang.png" srcSet="/modularization-examples/static/4369a235f2e1dc45bac63813538889d8/0d3e1/luoyang.png 140w,/modularization-examples/static/4369a235f2e1dc45bac63813538889d8/6b1e2/luoyang.png 281w,/modularization-examples/static/4369a235f2e1dc45bac63813538889d8/410f3/luoyang.png 561w,/modularization-examples/static/4369a235f2e1dc45bac63813538889d8/99072/luoyang.png 842w,/modularization-examples/static/4369a235f2e1dc45bac63813538889d8/62a6a/luoyang.png 1122w,/modularization-examples/static/4369a235f2e1dc45bac63813538889d8/3af77/luoyang.png 2071w" sizes="(max-width: 561px) 100vw, 561px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy"/>
  </a>
    </span>
<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:561px">
      <a class="gatsby-resp-image-link" style="display:block" target="_blank" rel="noopener" href="/modularization-examples/modularization-examples/static/1ee0a81e895943b4ec696551b0322077/a1a4b/nanjing.png">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:63.57142857142857%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAB2HAAAdhwGP5fFlAAACMklEQVQ4y4VTTW/TQBD1r+Ef8DO4IHFDvQBFCEqLKEUo4soBiVMOPYEQXKiokFApbYGqCDVpVKlCqBX0QlI3SR27cRx/7Ppr7cfOJiFuicTIo7V3xm/e25nVLMtCp9PBz8NDTF2fxs2ZWdy5dx9T16axufUV3a6NI12HaVqI4xi6fox6o4EgCNDvu6jX62i12iqWpik0zjnCMFTBaq2G7eoOqjs1fNuu4MQwVCIb5kRRpL7zPMfYiu+ARqhkQcCQn40hyzIJkCBJEgVE9mP/AHMPHuLG7RkslB5jdn4B849KuHV3Di9evYbmOI5K9n0fnueDMY6AMVWA81Ayi4ZrqACPmy0svV3G0vI7bHzawIfVVax//oKVj2uoSGWabdtKyujnAZt/nfZJqsgE+pLEJCNFGjWFjKTTxv+MipumCcPoQMQhhBBKGfXCkyq17umpSmRSJh/KEhKY2BSditHPBEjrkJN8xN9ivuy8ZvQt+DGBBdIZophj1B3VzQIomTrLPAOTvXy51kH5zRF0Z6DM8yVgJGIkIsVBv4nd7m/s2Q18d3QEaTQGLayMh2pUfrUTXC2f4MqzFt7vBSrmehJwRPdSpYyLm09wubqIC+sl1Oz6QH6enWFIx5LLvSjN8XzLxdOVHgwnHTMcJVqRhybvoSW9zeUoZelEhiRZiMnNU2dYTD5vxf0iQ5Lsyzlnjo+01wOXY6UAiwwz6mTBzzMbrer6SXdZDM9xwSUgXQS6HHS//wC9TNK4+fOmNgAAAABJRU5ErkJggg==&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="nanjing" title="nanjing" src="/modularization-examples/static/1ee0a81e895943b4ec696551b0322077/410f3/nanjing.png" srcSet="/modularization-examples/static/1ee0a81e895943b4ec696551b0322077/0d3e1/nanjing.png 140w,/modularization-examples/static/1ee0a81e895943b4ec696551b0322077/6b1e2/nanjing.png 281w,/modularization-examples/static/1ee0a81e895943b4ec696551b0322077/410f3/nanjing.png 561w,/modularization-examples/static/1ee0a81e895943b4ec696551b0322077/99072/nanjing.png 842w,/modularization-examples/static/1ee0a81e895943b4ec696551b0322077/62a6a/nanjing.png 1122w,/modularization-examples/static/1ee0a81e895943b4ec696551b0322077/a1a4b/nanjing.png 2054w" sizes="(max-width: 561px) 100vw, 561px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy"/>
  </a>
    </span>
<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:561px">
      <a class="gatsby-resp-image-link" style="display:block" target="_blank" rel="noopener" href="/modularization-examples/modularization-examples/static/505f336fae35927bdc4b02544d42925e/a1a4b/beijing.png">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:66.42857142857143%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAB2HAAAdhwGP5fFlAAACTklEQVQ4y21TyW7UQBD1T3GFA3/BBQSJUFgVCIuQuHIgQkgcIsSNC1du3EAMIDYhIRSUgZBZMpNtxvZ47Xbb0/ajqjzjQKCkkuXq6uf3XpUda0vs7e3B8zy03r7DqTNncXXlFi4tX8fSlWXs7O5iONzB9mCAOEkQBAH6/W3pt9Zif/8Ag8EQOsvA4diyhDEGRVEgDCNsdbro9HrodHvo9vrSyOcZZZ7nyKmPQceuC8/34boeXK9OfzKBo5QSMI6EGJTEuIkKBFJIGpMLI45Ha49xevE8zi1dxI07d7F44TKWb97GAr07GTEoyxokDEOkaQqtMyilobQGn2eZkdp0OkVVVfi5uYn3Hz9ho91G+/s62u0Nqv3Ct/V1OHEcwyfq3BwEoQCxNJbJrObJoNwz//DBaFSrKLU8+IwVOHyRG9ibNFXCRDzLjiYztOwCJuTVYDiEUSnhxXIeRTESUieSx+OxJAPO2dQMD5NrzIDt4UEpupw3ZpdUr4iMhsOe+RNfylyY2tqnoylAcm5hCFxiewutV1/xw61f2S4BjGhdOAwPaDZlwvgLkIMZslfcJ9JX1/Bg5RmuPVdyQRjGaYJ9fwQ9NfAiH5GKkeYatrQz4ENAZsmg2Yzhiy8RFp6M8bRVE+KtcGxloQoNXWSI8hShob8hS2Bs0QD++RRAYxr3RnEl+9oAzvoQE8NjL+/h5JuHONFaxfHX96Ft/g9LBuS1SkyFnCYLUhSYetV4WM68sSCJH7xOk5/9HmxV/lc2b0aQ5kgnARJaITeJaepK1uY3AB7S87x/a48AAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="beijing" title="beijing" src="/modularization-examples/static/505f336fae35927bdc4b02544d42925e/410f3/beijing.png" srcSet="/modularization-examples/static/505f336fae35927bdc4b02544d42925e/0d3e1/beijing.png 140w,/modularization-examples/static/505f336fae35927bdc4b02544d42925e/6b1e2/beijing.png 281w,/modularization-examples/static/505f336fae35927bdc4b02544d42925e/410f3/beijing.png 561w,/modularization-examples/static/505f336fae35927bdc4b02544d42925e/99072/beijing.png 842w,/modularization-examples/static/505f336fae35927bdc4b02544d42925e/62a6a/beijing.png 1122w,/modularization-examples/static/505f336fae35927bdc4b02544d42925e/a1a4b/beijing.png 2054w" sizes="(max-width: 561px) 100vw, 561px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy"/>
  </a>
    </span>
<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:561px">
      <a class="gatsby-resp-image-link" style="display:block" target="_blank" rel="noopener" href="/modularization-examples/modularization-examples/static/958ad233dce5e0a32d07d1658f53b835/6297e/beijing2.png">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:86.42857142857143%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAB2HAAAdhwGP5fFlAAACJklEQVQ4y4VTy2oUQRTtr3LrJ7h260aCQYyKICKoaJDgH+jCVRZCNi7ciKCIYLKYBCM9iSJGcKIz/X4/q491bqdnJknPeOFO1VR1nTrn3FtGGIao6xpKKXiejyzLkeeFznwuC72eoWkamT94vI4rV1ewcn0Nt+/ew7UbN7G6dguP1p/CSNMUDAL6vo80zQT0bHKd3zAHe3v4vL2D4dCE+fULzINDmMMDHH77DsN1Xc3MQ1lWcF3vhN35JCiVMAK/VdKGkl+y574wJLOyLBHHsUjsY8jsGFJ+B1bXSkalAZMkhUEPR6MROFLWMoYzwJbd2/0E91/Z2PnRXpDo85phgvF4DErv/GvH08k1kaUBi0LL18TubFq49OwYG69dAUz1dwb9Y1ZVJZQr7UPdk9wvikLmHcMPZoqHWw52j/IZwyAIkCZtpaXiDXqD7DpA+twXVCJVDqNQ4zQIwkAY0uC+oH9kSk8ZeQU4Yc7bpoSMIItgRS44/g0sTEIHduzKQVWrU7LJkqBURRJBGMNyfPkf6Q6Jk0QzdFxZoNQoWtw2LErXh1M/9VjpduOcawzxcDKZTIty/tnlc42tsCyowIiiSLQr1UiDt2+5n2XHkAcXpWHbtkhmISzHRqIr1eU8y7OAi0Ik88lJFCdPk6nPdnJFcj6TvBSw2zrOfLz4+RFbvwd4efQJb/7sL/RpWRh109468H7hwrsnuLz9HBffb2B1d7PXr/+B/gM7JhnoGibRKQAAAABJRU5ErkJggg==&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="beijing2" title="beijing2" src="/modularization-examples/static/958ad233dce5e0a32d07d1658f53b835/410f3/beijing2.png" srcSet="/modularization-examples/static/958ad233dce5e0a32d07d1658f53b835/0d3e1/beijing2.png 140w,/modularization-examples/static/958ad233dce5e0a32d07d1658f53b835/6b1e2/beijing2.png 281w,/modularization-examples/static/958ad233dce5e0a32d07d1658f53b835/410f3/beijing2.png 561w,/modularization-examples/static/958ad233dce5e0a32d07d1658f53b835/99072/beijing2.png 842w,/modularization-examples/static/958ad233dce5e0a32d07d1658f53b835/62a6a/beijing2.png 1122w,/modularization-examples/static/958ad233dce5e0a32d07d1658f53b835/6297e/beijing2.png 2044w" sizes="(max-width: 561px) 100vw, 561px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy"/>
  </a>
    </span></p><p>其核心逻辑是收集房子，卖家，买家三个业务实体的属性。然后根据当地的法规制度，计算出各种税费的税率，然后算出总共应该交的税费的总表。</p><h1 id="单个-react-组件">单个 React 组件</h1><p>我们可以把所有这些城市的业务逻辑，都实现在一个 React 组件里。</p><ul><li>渲染空的表单</li><li>响应表单的用户输入</li><li>计算出表单的联动状态</li><li>响应开始计算按钮</li><li>实现计算逻辑</li><li>渲染税费总表和饼图</li></ul><p>React 16 的函数式组件就是一个函数。我们可以认为，整个业务也就是一个超级大的函数。这个函数通过 useState，包含了在页面上的状态。如果我们把 useState 通过 local storage 持久化，可以认为这是一个包含了数据库的，前后端一体的完整应用程序。如果我们再把这个界面给买家，卖家分别使用，各自填写自己的信息。那么这个函数就实现了一个多角色协作的业务流程。</p><h1 id="调整模块边界">调整模块边界</h1><p>一个函数包含了</p><ul><li>展示界面，业务计算，持久化</li><li>买家，卖家</li><li>北京，南京，洛阳……</li><li>增值税，契税……</li></ul><p>显然，对这一个 React 组件，我们需要进行模块化拆分。我们可以有多种模块之间边界的选择</p><ul><li>一个组件只负责展示，一个函数负责逻辑计算，一个函数负责数据库读写</li><li>一个组件面向买家，一个组件面向卖家</li><li>一个组件负责抽象的计算器，每个城市一个实例化的组件装配自己的参数</li><li>每个税费种类一个模块，然后把税费各自依赖的输入合并成一个大的表单</li></ul><p>不同的模块边界选择，是基于对于“什么是易变”的不同判断。这样可以尽量把易变的部分隔离到独立的模块里去修改。假设说，我们判断，城市是易变的。希望做到新增一个城市的时候，可以只是新增一个模块。那么，模块拆分之后大概是这个样子：</p><pre><code class="language-tsx">function TaxCalculator(props: {
    fields: { shouldShowIsOnlyApartment: boolean, ... },
    calcTaxRates: () =&gt; { qisuiRate: number, zengzhisuiRate: number, ... }
}) {
    return &lt;div&gt; ... &lt;/div&gt;
}

function BeijingTaxCalculator() {
    function calcBeijingTaxRate(props) {
        // ...
    }
    return &lt;TaxCalculator fields={fields} calcTaxRates={calcBeijingTaxRates} /&gt;
}
</code></pre><h1 id="调整模块的打包和部署模式">调整模块的打包和部署模式</h1><p>调整有两个方向</p><ul><li>保持打包部署模式不变，调整模块之间的边界，重新定义接口</li><li>保持模块边界不变，保持接口不变，但是调整打包和部署模式</li></ul><p>那么在保持上面定义的模块边界的前提下，我们有哪些打包和部署的选择呢?</p><h2 id="配置化">配置化</h2><p>在上面的例子里，fields 和 calcBeijingTaxRates 这两个参数是程序员在源代码编辑的阶段给定的。这种打包和部署模式是以源代码git管理参数的模式。
我们可以选择把 fields 和 calcBeijingTaxRates，从源代码里提取出来，放到配置系统里。运行时就可以不用改源代码，不用重新走源代码发布系统，而是通过配置发布系统来发布了。</p><h2 id="自助化">自助化</h2><p>配置系统往往仍然是一个高风险的操作。可以进一步把这个配置做成图形化界面，由运营人员在运营系统里直接修改。甚至可以提供拖拽的方式，让运营人员去做一些字段顺序调整的事情。再高级一点，可以搞出 lowcode 的概念来。</p><h2 id="静态求值">静态求值</h2><p>我们知道，如果我们在代码里写了 3 * 5 的话，编译器会在编译的时候直接优化成15，而不是运行时再去计算。我们这里，静态传递了参数</p><pre><code class="language-tsx">&lt;TaxCalculator fields={fields} calcTaxRates={calcBeijingTaxRates} /&gt;
</code></pre><p>那编译器也可以进行“静态求值”，就是把 fields 和 calcBeijingTaxRates 代入到函数里，静态生成一个北京版的计算器。这个做法也就是所谓的代码生成。</p><h2 id="feature-branch">Feature Branch</h2><p>比静态代码生成更静态的办法就是给每一个城市一个 git 分支，把这个城市的特殊逻辑维护到这个 git 分支里。</p><h2 id="静态链接--动态链接--微服务">静态链接 / 动态链接 / 微服务</h2><p>常见的 .a 文件和 .so 文件也是打包部署技术，微服务独立一个 RPC 进程也是打包部署技术。这个就不赘述了。</p></div><a aria-current="page" class="obstructed-label" href="/modularization-examples/autonomy/module-boundary-unchanged/packaging-deployment/README">单个 React 组件</a></div></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/autonomy/module-boundary-unchanged/packaging-deployment/README";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-b26ca15045427b9506aa.js"],"app":["/app-2cf9a07a48aadf00be9a.js"],"component---node-modules-gatsby-theme-gardenx-src-templates-local-file-js":["/component---node-modules-gatsby-theme-gardenx-src-templates-local-file-js-f7490a33359932c9c39b.js"]};/*]]>*/</script><script src="/modularization-examples/polyfill-b26ca15045427b9506aa.js" nomodule=""></script><script src="/modularization-examples/webpack-runtime-17b9bea5f0059a6131f0.js" async=""></script><script src="/modularization-examples/framework-06f646d936b841f99ebd.js" async=""></script><script src="/modularization-examples/app-2cf9a07a48aadf00be9a.js" async=""></script><script src="/modularization-examples/styles-407fe62976dc5310c43e.js" async=""></script><script src="/modularization-examples/component---node-modules-gatsby-theme-gardenx-src-templates-local-file-js-f7490a33359932c9c39b.js" async=""></script></body></html>